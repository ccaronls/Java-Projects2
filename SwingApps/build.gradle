apply plugin: 'application'
apply plugin: 'java'
apply plugin: 'kotlin'
apply plugin: 'com.google.devtools.ksp'
apply plugin: 'org.jetbrains.kotlin.plugin.serialization'

mainClassName = 'cc.game.swing.AWTBoardBuilder'

configurations {
    swingLib.extendsFrom(main)
}

dependencies {
    // https://mvnrepository.com/artifact/org.json/json
    implementation group: 'org.json', name: 'json', version: '20090211'
    implementation group: 'net.sourceforge.jaadec', name: 'jaad', version: '0.8.5'
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-swing:1.3.9")
    implementation("org.jetbrains.kotlinx:kotlinx-serialization-json:1.6.3")

    // TODO: Should eb able to isolate the game lib for each swing app
    implementation project(':GameLibrary')
    implementation project(':KSPCommon')
    implementation project(':Dominos')
    implementation project(':othello')
    implementation project(':Zombicide')
    implementation project(':Monopoly')
    implementation project(':Probot')
    implementation project(':Risk')
    implementation project(':GeniusSquares')
    implementation project(':Yahtzee')
    implementation project(':Checkerboard')
    implementation project(':Kaiser')
    implementation project(':SuperRobotron')
    implementation project(':SOC')
    implementation project(':Risk')
}

sourceSets {
    main {
        java {
            srcDirs = [ 'src', 'apps' ]
        }
        resources {
            srcDirs = [ 'resources', 'images', 'gifs', 'zpngs', 'playingCards' ]
        }
    }

    test {
//        useJUnitPlatform()
        java {
            srcDirs = ['test']
        }

        resources {
            srcDirs = ['testResources']
        }
    }

    swingLib {
        java {
            srcDirs = [ 'src ']
        }
    }
}

task swingLibJar(type: Jar) {
    from sourceSets.swingLib.output.classesDirs
    archiveName("SwingLib.jar")
}

artifacts {
    swingLib swingLibJar
}

tasks.withType(JavaExec) {
    workingDir = "${rootDir}"
    classpath sourceSets.main.runtimeClasspath
    group = 'Application'
    standardInput = System.in
}

task runCheckers(type: JavaExec) {
    description = 'Run the Checkers Applet'
    main = "cc.lib.swing.AWTCheckers"
}

task runCheckerboard(type: JavaExec) {
    description = 'Run the Checkerboard Applet'
    main = "cc.lib.swing.AWTCheckerboard"
}

task runBoardBuilder(type: JavaExec) {
    description = 'Run the Custum Board Builder App'
    main = "cc.lib.swing.AWTBoardBuilder"
}

task runDungeonBuilder(type: JavaExec) {
    description = 'Run the Dungeon Builder Applet App'
    main = "cc.applets.dungeonbb.AWTDungeonBuilder"
}

task runMonopoly(type: JavaExec) {
    description = 'Run Monopoly App'
    main = "cc.applets.monopoly.AWTMonopoly"
}

task runProbotLevelBuilder(type: JavaExec) {
    description = 'Run Probot Level Editor App'
    main = "cc.applets.probotbb.AWTProbotLevelBuilder"
}

task runYahtzeeConsole(type: JavaExec) {
    description = 'Run Yahtzee Console version'
    main = "cc.console.YahtzeeConsole"
}

task runMasterMindConsole(type: JavaExec) {
    description = 'Run Master Mind Consoel version'
    main = "cc.console.MasterMindConsole"
}

task runProbot(type: JavaExec) {
    description = 'Run Probot Desktop App'
    main = "cc.applets.probot.AWTProbot"
}

task runAudioClient(type: JavaExec) {
    description = 'Run the audio client'
    main = "cc.audio.stream.server.AudioClient"
}

task runZombicide(type: JavaExec) {
    description = 'Play Zombicide!'
    main = "cc.applets.zombicide.ZombicideApplet"
}

task runDominos(type: JavaExec) {
    description = 'Run the Dominos App'
    main = "cc.applets.dominos.DominosApplet"
}

task runKaiserConsole(type: JavaExec) {
    description = 'Run Kaiser Console'
    main = "cc.console.KaiserConsole"
}

task runKaiser(type: JavaExec) {
    description = 'Run Kaiser Applet'
    main = "cc.capplets.kaiser.KaiserApplet"
}

task runRisk(type: JavaExec) {
    description = 'Run Risk Applet'
    main = "cc.applets.risk.AWTRisk"
}

task deployLearnToTypeApplet {
    dependsOn tasks.withType(Jar)
    group = 'Distribution'
    description = 'Deply the Learn to Type Applet to Sites'
    def homePath = System.properties['user.home']
    doLast {
        copy {
            from 'build/libs/GameLibrary.jar'
            into homePath + '/Sites/learnToType/'
        }
        copy {
            from 'html/TypingTeacher/'
            into homePath + '/Sites/learnToType/'
        }
    }
}

task deployZombicideApplet {
    dependsOn tasks.withType(Jar)
    group = 'Distribution'
    description = 'Deply the Zombicide Applet to Sites'
    def homePath = System.properties['user.home']
    def zPath = homePath + '/Sites/Zombicide/'
    doLast {
        delete zPath
        copy {
            from 'build/libs/GameLibraryApplet.jar'
            into zPath
        }
        copy {
            from 'html/Zombicide/'
            into zPath
        }
    }
}
